qmatlab = pwd;

mols = {    ...
    'ON_C4N', 1:23, 24:32, [10 24]; ...
    'ON_C4O', 1:23, 24:31, [10 24]; ...
    'ON_C4P', 1:23, 24:32, [10 24]; ... 
    'ON_C4S', 1:23, 24:31, [10 24]; ...
    'ON_C6', 1:23, 24:34, [10 24]; ...
    'OP_C4N', 1:23, 24:32, [10 24]; ...
    'OP_C4O', 1:23, 24:31, [10 24]; ...
    'OP_C4P', 1:23, 24:32, [10 24]; ... 
    'OP_C4S', 1:23, 24:31, [10 24]; ...  
    'OP_C6', 1:23, 24:34, [10 24]; ...
    'SN_C4N', 1:23, 24:32, [10 24]; ...
    'SN_C4O', 1:23, 24:31, [10 24]; ...
    'SN_C4P', 1:23, 24:32, [10 24]; ...
    'SN_C4S', 1:23, 24:31, [10 24]; ...
    'SN_C6', 1:23, 24:34, [10 24]; ...
    'SP_C4N', 1:23, 24:32, [10 24]; ...
    'SP_C4O', 1:23, 24:31, [10 24]; ...
    'SP_C4P', 1:23, 24:32, [10 24]; ...
    'SP_C4S', 1:23, 24:31, [10 24]; ...
    'SP_C6', 1:23, 24:34, [10 24]; ...
};

dataPath = 'C:\Users\Nicole\Documents\Research\QCmatlab\Noonan\';

for i=1:size(mols,1)  
    disp(mols{i, 1});
    gstart = Gaussian(dataPath,mols{i,1},struct);
    gstart.run();

    fragList{1} = mols{i,2};
    fragList{2} = mols{i,3};
    links = mols{i,4};
    rlinks = [1.1 1.1];
    keywords = 'b3lyp/6-31g';
    obj = Decompose(gstart,fragList,links,rlinks,keywords);
    obj.initialize();
    results{i} = obj;

    homo = results{i}.full.Nelectrons/2;
    e(i*2-1) = results{i}.full.Eorb(homo+6);
    e(i*2) = results{i}.full.Eorb(homo-5);
end


save([dataPath, 'Results.mat']);

ymax = max(e);
ymin = min(e);
for i=1:size(results,1)
    results{i}.draw(1,i);
    figure(i * 2 - 1);
    axis([0 5 ymin ymax]);
end